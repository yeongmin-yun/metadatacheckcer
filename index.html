<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Component Explorer</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- D3.js CDN for visualization -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <!-- SheetJS CDN for XLSX generation -->
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <!-- JSZip CDN for ZIP file generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <style>
        /* Custom font for better aesthetics */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Styles for button text truncation */
        .btn-truncate {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: block;
            /* Ensure block display for text-overflow to work */
        }
        
        /* Animation for containers */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
        }

        .slide-up {
            transition: max-height 0.5s ease-in-out, opacity 0.3s ease-in-out;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* D3 graph styles */
        .node circle {
            stroke: #fff;
            stroke-width: 1.5px;
        }

        .node text {
            font-size: 10px;
            fill: #333;
            pointer-events: none;
        }

        .link {
            stroke: #555;
            stroke-opacity: 0.4;
            stroke-width: 1.5px;
        }
    </style>
</head>

<body class="bg-gray-50">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside class="w-72 flex-shrink-0 bg-white shadow-lg p-6 overflow-y-auto">
            <h1 class="text-2xl font-bold text-gray-800 mb-8">Nexacro Utils</h1>
            <nav class="mt-8">
                <ul>
                    <li>
                        <a href="#" id="home-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                            <span class="ml-3 font-semibold">Home</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" id="metainfo-analyzer-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                            <span class="ml-3 font-semibold">Metainfo 분석기</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" id="component-analyzer-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                            <span class="ml-3 font-semibold">Component 분석기</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" id="cats-sample-maker-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                            <span class="ml-3 font-semibold">CATS SAMPLE MAKER</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" id="metainfo-maker-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                            <span class="ml-3 font-semibold">MetaInfo Maker</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-8 overflow-y-auto bg-gray-100">
            <!-- Home Content -->
            <div id="home-content" class="hidden">
                <h2 class="text-3xl font-bold text-gray-800">Welcome to Nexacro Utils</h2>
                <p class="mt-4 text-gray-600">Select a tool from the sidebar to get started.</p>
            </div>

            <!-- Metainfo Analyzer Content -->
            <div id="metainfo-analyzer-content" class="hidden">
                <h2 class="text-3xl font-bold text-gray-800">Metainfo 분석기</h2>
                <div id="xmlCsvTab" class="tab-content space-y-8 mt-8 bg-white">
                    <div class="p-6 border border-gray-200 rounded-lg space-y-6">
                        <h2 class="text-2xl font-bold text-gray-800">INFO 분석 및 CSV 생성</h2>
                        <div class="flex flex-col space-y-4">
                            <label for="xmlFileInput" class="text-lg font-semibold text-gray-700">INFO 파일 선택:</label>
                            <input type="file" id="xmlFileInput" accept=".info" class="w-full p-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/>
                            <p class="text-sm text-gray-500">분석할 INFO 메타 정보 파일을 선택하세요. (예: SpinField.info)</p>
                            <textarea id="xmlInput" class="hidden"></textarea>
                        </div>
                        <div class="flex justify-center flex-wrap gap-6">
                            <button id="generateCSVEvent" class="px-8 py-3 bg-green-600 text-white font-bold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-200">
                                이벤트 CSV 다운로드
                            </button>
                            <button id="generateCSVMethod" class="px-8 py-3 bg-purple-600 text-white font-bold rounded-lg shadow-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-200">
                                메서드 CSV 다운로드
                            </button>
                            <button id="generateCSVStatus" class="px-8 py-3 bg-yellow-500 text-white font-bold rounded-lg shadow-md hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-offset-2 transition duration-200">
                                상태 CSV 다운로드
                            </button>
                            <button id="generateCSVControl" class="px-8 py-3 bg-red-500 text-white font-bold rounded-lg shadow-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 transition duration-200">
                                컨트롤 CSV 다운로드
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Component Analyzer Content -->
            <div id="component-analyzer-content">
                <!-- Search Input Field -->
                <div class="mb-6">
                    <label for="search-input" class="block text-sm font-medium text-gray-600 mb-2">Search Component</label>
                    <input type="text" id="search-input" placeholder="e.g., Button"
                        class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm transition">
                </div>
                <div id="button-container">
                    <!-- Buttons will be dynamically inserted here by JavaScript -->
                    <p id="loading-message" class="text-center text-gray-500 col-span-full text-lg">Loading data...</p>
                </div>

                <!-- Visualization Container -->
                <div id="visualization-container" class="hidden">
                    <div id="graph-header" class="flex justify-between items-center mb-6">
                        <h2 class="text-3xl font-bold text-gray-800">Component Analysis</h2>
                        <button id="download-xlsx-button"
                            class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out">
                            Download Analysis (XLSX)
                        </button>
                    </div>

                    <!-- Top section with Pie Charts and Tables -->
                    <div class="flex flex-wrap -mx-4 mb-8">
                        <!-- Left Column: Properties -->
                        <div class="w-full lg:w-1/2 px-4 mb-8 lg:mb-0">
                            <div class="bg-white rounded-lg shadow-lg p-4 h-full flex flex-col">
                                <div id="property-pie-chart-container" class="flex-grow flex flex-col" style="height: 400px;">
                                    <p id="pie-chart-component-name" class="text-xl font-bold text-gray-800 text-center pt-2"></p>
                                    <div class="flex-grow flex justify-center items-center">
                                        <svg id="property-pie-chart-svg" class="w-full h-full"></svg>
                                    </div>
                                    <div class="text-xs text-gray-600 text-left p-2">
                                        <ul>
                                            <li class="flex items-center mb-1"><span id="legend-common-prop" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Common:</b> In code & metainfo.</li>
                                            <li class="flex items-center mb-1"><span id="legend-missing-prop" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Missing:</b> In code, not metainfo.</li>
                                            <li class="flex items-center"><span id="legend-extra-prop" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Extra:</b> In metainfo, not code.</li>
                                        </ul>
                                    </div>
                                </div>
                                 <div id="property-table-container" class="relative mt-4 p-4 border-t border-gray-200 hidden" style="height: 300px; overflow-y: auto;">
                                    <h3 id="property-table-title" class="text-lg font-bold text-gray-800 mb-2">Properties</h3>
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <tbody id="property-table-body" class="bg-white divide-y divide-gray-200">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column: Events -->
                        <div class="w-full lg:w-1/2 px-4">
                             <div class="bg-white rounded-lg shadow-lg p-4 h-full flex flex-col">
                                <div id="event-pie-chart-container" class="flex-grow flex flex-col" style="height: 400px;">
                                    <p id="event-pie-chart-component-name" class="text-xl font-bold text-gray-800 text-center pt-2"></p>
                                    <div class="flex-grow flex justify-center items-center">
                                        <svg id="event-pie-chart-svg" class="w-full h-full"></svg>
                                    </div>
                                    <div class="text-xs text-gray-600 text-left p-2">
                                        <ul>
                                            <li class="flex items-center mb-1"><span id="legend-common-event" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Common:</b> In code & metainfo.</li>
                                            <li class="flex items-center mb-1"><span id="legend-missing-event" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Missing:</b> In code, not metainfo.</li>
                                            <li class="flex items-center"><span id="legend-extra-event" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Extra:</b> In metainfo, not code.</li>
                                        </ul>
                                    </div>
                                </div>
                                <div id="event-table-container" class="relative mt-4 p-4 border-t border-gray-200 hidden" style="height: 300px; overflow-y: auto;">
                                    <h3 id="event-table-title" class="text-lg font-bold text-gray-800 mb-2">Events</h3>
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <tbody id="event-table-body" class="bg-white divide-y divide-gray-200">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bottom section with Inheritance Graph -->
                    <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Inheritance Graph</h3>
                        <div id="graph-container" class="relative bg-gray-50 rounded-lg w-full" style="height: 600px;">
                            <svg id="inheritance-graph-svg" class="w-full h-full border border-gray-200 rounded-md"></svg>
                        </div>
                    </div>

                    <!-- NEW: Debug Event Log Section -->
                    <div id="log-container" class="bg-white rounded-lg shadow-lg p-6 hidden">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Debug Event Log</h3>
                        <div class="bg-gray-900 text-white font-mono text-sm p-4 rounded-lg overflow-x-auto" style="max-height: 400px;">
                            <pre id="log-content"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CATS Sample Maker Content -->
            <div id="cats-sample-maker-content" class="hidden">
                <h2 class="text-3xl font-bold text-gray-800">CATS SAMPLE MAKER</h2>
                        <div id="catsSamplingTab" class="tab-content space-y-8  mt-8 bg-white">
                            <div class="p-6 border border-gray-200 rounded-lg space-y-6">
                                <div class="flex justify-between items-center">
                                    <h2 class="text-2xl font-bold text-gray-800">4. CATS 샘플링 코드 생성</h2>
                                    <a href="./CATS_onBoarding.html" target="_blank" class="px-6 py-2 bg-sky-600 text-white font-bold rounded-lg shadow-md hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 transition duration-200 text-sm">
                                        CATS API 가이드
                                    </a>
                                </div>
                                <div class="flex flex-col space-y-4">
                                    <label for="xfdlFileInput" class="text-lg font-semibold text-gray-700">XFDL 파일 선택:</label>
                                    <input type="file" id="xfdlFileInput" accept=".xfdl" multiple class="w-full p-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/>
                                    <p class="text-sm text-gray-500">분석할 XFDL 파일을 선택하세요. (단일 또는 다중 선택 가능)</p>
                                </div>
                                <div id="singleFileAction" class="flex justify-center">
                                    <button id="extractScriptBtn" class="px-8 py-3 bg-teal-600 text-white font-bold rounded-lg shadow-md hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 transition duration-200">
                                        스크립트 추출
                                    </button>
                                </div>

                                <!-- 단일 파일 스크립트 수정 영역 -->
                                <div id="scriptOutput" class="mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200 space-y-6">
                                    <div>
                                        <h3 class="text-xl font-bold text-gray-800 mb-4">스크립트 수정 및 복사</h3>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                            <div>
                                                <label for="authorNameInput" class="block text-sm font-medium text-gray-700">작성자명</label>
                                                <input type="text" id="authorNameInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="새 작성자명을 입력하세요">
                                            </div>
                                            <div>
                                                <label for="creationDateInput" class="block text-sm font-medium text-gray-700">작성일</label>
                                                <input type="text" id="creationDateInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="YYYY.MM.DD (기본값: 오늘)">
                                            </div>
                                            <div>
                                                <label for="originalCompNameInput" class="block text-sm font-medium text-gray-700">현재 컴포넌트명 (파일명에서 추출)</label>
                                                <input type="text" id="originalCompNameInput" class="mt-1 block w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md shadow-sm sm:text-sm" readonly>
                                            </div>
                                            <div>
                                                <label for="newCompNameInput" class="block text-sm font-medium text-gray-700">새 컴포넌트명</label>
                                                <input type="text" id="newCompNameInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="새 컴포넌트명을 입력하세요">
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <label for="editableScript" class="block text-sm font-medium text-gray-700 mb-1">추출된 스크립트 (편집 가능)</label>
                                        <textarea id="editableScript" class="w-full p-4 rounded-md text-sm border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500" rows="15"></textarea>
                                    </div>
                                    <div class="flex gap-4 mt-4">
                                        <button id="copyScriptBtn" class="px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                            수정 및 복사
                                        </button>
                                        <button id="downloadXfdlBtn" class="px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
                                            XFDL 다운로드
                                        </button>
                                    </div>
                                </div>

                                <!-- 다중 파일 처리 영역 -->
                                <div id="batchScriptOutput" class="mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200 space-y-6">
                                    <h3 class="text-xl font-bold text-gray-800 mb-4">다중 CATS Script 작성</h3>
                                    <p id="batchFileCount" class="text-md text-gray-600"></p>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                        <div>
                                            <label for="batchAuthorNameInput" class="block text-sm font-medium text-gray-700">일괄 적용할 작성자명</label>
                                            <input type="text" id="batchAuthorNameInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="새 작성자명을 입력하세요">
                                        </div>
                                        <div>
                                            <label for="batchCreationDateInput" class="block text-sm font-medium text-gray-700">일괄 적용할 작성일</label>
                                            <input type="text" id="batchCreationDateInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="YYYY.MM.DD (기본값: 오늘)">
                                        </div>
                                        <div class="md:col-span-2">
                                            <label for="batchNewCompNameInput" class="block text-sm font-medium text-gray-700">일괄 적용할 새 컴포넌트명</label>
                                            <input type="text" id="batchNewCompNameInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="각 파일의 컴포넌트명을 이 이름으로 변경">
                                        </div>
                                    </div>
                                    <div class="flex justify-center">
                                        <button id="downloadAllXfdlBtn" class="px-8 py-3 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200">
                                            수정된 XFDL 전체 다운로드 (ZIP)
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
            </div>

            <!-- MetaInfo Maker Content -->
            <div id="metainfo-maker-content" class="hidden">
                <h2 class="text-3xl font-bold text-gray-800">MetaInfo Maker</h2>
                
                <!-- Step 1: Template Creation -->
                <div id="metainfo-step-1" class="mt-8 bg-white p-6 border border-gray-200 rounded-lg space-y-6">
                    <h3 class="text-xl font-bold text-gray-800">Step 1: Start by Creating a Template</h3>
                    <p class="text-gray-600">
                        새로운 .info 파일을 만들거나, 기존 파일을 업로드하여 시작하세요.
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                        <!-- Option A: Create New -->
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-gray-700">Create a new .info file from scratch</label>
                            <button id="createNewInfoBtn" class="w-full px-6 py-2 bg-indigo-600 text-white font-bold rounded-lg shadow-md hover:bg-indigo-700">
                                Create New .info (Start with Blank Template)
                            </button>
                            <p class="text-sm text-gray-500 mt-1">빈 XLSX 템플릿으로 시작합니다.</p>
                        </div>
                        <!-- Option B: Upload Existing -->
                        <div class="space-y-2">
                            <label for="existingInfoFileInput" class="block text-sm font-medium text-gray-700">Modify an existing .info file</label>
                            <input type="file" id="existingInfoFileInput" accept=".info" class="w-full p-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-yellow-50 file:text-yellow-700 hover:file:bg-yellow-100"/>
                            <p class="text-sm text-gray-500 mt-1">기존 .info 파일을 업로드하여 수정합니다.</p>
                        </div>
                    </div>
                     <div class="mt-4">
                        <label for="newComponentNameInput" class="block text-sm font-medium text-gray-700 mb-1">New Component Name (Optional)</label>
                        <input type="text" id="newComponentNameInput" placeholder="Enter new component name to replace" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 sm:border-indigo-500 sm:text-sm">
                        <p class="text-sm text-gray-500 mt-1">새 컴포넌트 이름을 입력하면 다운로드되는 XLSX 파일의 컴포넌트 이름이 변경됩니다.</p>
                    </div>
                    <div class="mt-6 flex justify-end">
                        <button id="step1NextBtn" class="px-6 py-2 bg-green-600 text-white font-bold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 opacity-50 cursor-not-allowed" disabled>
                            Next Step
                        </button>
                    </div>
                </div>

                <!-- Step 2: Add Elements -->
                <div id="metainfo-step-2" class="mt-8 bg-white p-6 border border-gray-200 rounded-lg space-y-8 hidden">
                    <h3 class="text-xl font-bold text-gray-800">Step 2: Add or Review Elements</h3>
                    <p class="text-gray-600">
                        필요한 항목을 추가하거나 기존 항목을 검토/제거하세요.
                    </p>
                    
                    <!-- Row 1: Properties -->
                    <div class="pt-4 border-t border-gray-200">
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">Properties</h4>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Add New Properties</h5>
                                <input type="text" id="property-search" placeholder="Search properties..." class="w-full p-2 border border-gray-300 rounded-lg mb-2">
                                <div id="properties-container" class="h-64 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Current Properties</h5>
                                <div id="selected-properties-container" class="h-80 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 2: Controls -->
                    <div class="pt-8 border-t border-gray-200">
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">Controls</h4>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Add New Controls</h5>
                                <input type="text" id="control-search" placeholder="Search controls..." class="w-full p-2 border border-gray-300 rounded-lg mb-2">
                                <div id="controls-container" class="h-64 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Current Controls</h5>
                                <div id="selected-controls-container" class="h-80 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 3: Statuses -->
                    <div class="pt-8 border-t border-gray-200">
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">Statuses</h4>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Add New Statuses</h5>
                                <input type="text" id="status-search" placeholder="Search statuses..." class="w-full p-2 border border-gray-300 rounded-lg mb-2">
                                <div id="statuses-container" class="h-64 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Current Statuses</h5>
                                <div id="selected-statuses-container" class="h-80 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Download Template -->
                <div id="metainfo-step-3" class="mt-8 bg-white p-6 border border-gray-200 rounded-lg space-y-4 hidden">
                    <h3 class="text-xl font-bold text-gray-800">Step 3: Download Template</h3>
                    <p class="text-gray-600 mb-4">
                        모든 준비가 완료되면 아래 버튼을 클릭하여 최종 XLSX 템플릿을 다운로드하세요.
                    </p>
                    <button id="downloadTemplateBtn" class="w-full px-6 py-3 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        Generate and Download XLSX
                    </button>
                </div>

                <!-- Step 4: Upload and Generate -->
                <div id="metainfo-step-4" class="mt-8 bg-white p-6 border border-gray-200 rounded-lg space-y-4 hidden">
                    <h3 class="text-xl font-bold text-gray-800">Step 4: Generate .info File</h3>
                    <p class="text-gray-600 mb-4">작성한 XLSX 파일을 업로드하여 .info 파일을 생성하세요.</p>
                    <div class="flex flex-col space-y-4">
                        <input type="file" id="infoFileInput" accept=".xlsx" class="w-full p-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"/>
                        <button id="generateInfoBtn" class="px-6 py-2 bg-green-600 text-white font-bold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 opacity-50 cursor-not-allowed" disabled>
                            Generate .info File
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="./js/features/csv-generator.js"></script>
    <script src="./js/features/test-generator.js"></script>
    <script src="./js/features/cats-sampler.js"></script>
    <script src="./js/features/metainfo-maker.js"></script>
    <script src="animations.js" defer></script>
    <script type="module" src="main.js" defer></script>
    <script type="module" src="utils.js" defer></script>
    
</body>

</html>
