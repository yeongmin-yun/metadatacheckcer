<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Component Explorer</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <style>
        /* Custom font for better aesthetics */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Styles for button text truncation */
        .btn-truncate {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: block;
            /* Ensure block display for text-overflow to work */
        }
        
        /* Animation for containers */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
        }

        .slide-up {
            transition: max-height 0.5s ease-in-out, opacity 0.3s ease-in-out;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* D3 graph styles */
        .node circle {
            stroke: #fff;
            stroke-width: 1.5px;
        }

        .node text {
            font-size: 10px;
            fill: #333;
            pointer-events: none;
        }

        .link {
            stroke: #555;
            stroke-opacity: 0.4;
            stroke-width: 1.5px;
        }
    </style>
</head>

<body class="bg-gray-50">
<div id="tooltip" class="hidden absolute z-50 px-3 py-2 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm" role="tooltip"></div>
<div id="toast-container" class="fixed top-5 right-5 z-50 space-y-2"></div>
<div class="flex h-screen">
    <!-- Sidebar Container -->
    <aside class="bg-white shadow-lg flex">
        <!-- Always visible part with the button -->
        <div class="p-4 border-r">
            <button id="sidebar-toggle" class="p-2 bg-gray-200 rounded-md hover:bg-gray-300">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                </svg>
            </button>
        </div>
        <!-- Expandable Navigation -->
        <div id="sidebar-content" class="transition-all duration-300 ease-in-out overflow-hidden w-0">
             <div class="p-6">
                <h1 class="text-2xl font-bold text-gray-800 mb-8 whitespace-nowrap">Nexacro Utils</h1>
                <nav id="tab-container">
                    <ul class="space-y-2">
                        <!-- Work Version Selector -->
                        <li id="work-version-selector" class="p-1 bg-gray-200 rounded-lg space-y-1">
                            <div class="flex justify-around">
                                <button id="work800-btn" data-version="WORK800" class="work-version-btn flex-1 py-2 px-4 text-sm font-semibold rounded-md bg-white text-blue-600 shadow">WORK800</button>
                                <button id="work900-btn" data-version="WORK900" class="work-version-btn flex-1 py-2 px-4 text-sm font-semibold rounded-md text-gray-600">WORK900</button>
                            </div>
                            <div class="flex justify-around text-xs text-gray-500 pt-1">
                                <span id="work800-date" class="flex-1 text-center"></span>
                                <span id="work900-date" class="flex-1 text-center"></span>
                            </div>
                        </li>

                        <!-- Home -->
                        <li>
                            <a href="#" id="home-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                                <span class="ml-3 font-semibold">Home</span>
                            </a>
                        </li>
                        
                        <!-- Separator -->
                        <li class="pt-2">
                            <hr class="border-gray-200">
                        </li>

                        <!-- Metainfo -->
                        <li class="pt-2">
                            <span class="ml-3 text-xs font-semibold text-gray-500 uppercase tracking-wider">Metainfo</span>
                        </li>
                        <li class="pt-2">
                            <hr class="border-gray-200">
                        </li>
                        <li>
                            <a href="#" id="metainfo-analyzer-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                                <span class="ml-6 font-semibold">Metainfo 분석기</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" id="metainfo-maker-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                                <span class="ml-6 font-semibold">Metainfo Generator</span>
                            </a>
                        </li>

                        <!-- Separator -->
                        <li class="pt-2">
                            <hr class="border-gray-200">
                        </li>

                        <!-- Component -->
                        <li class="pt-2">
                            <span class="ml-3 text-xs font-semibold text-gray-500 uppercase tracking-wider">Component</span>
                        </li>
                        <li class="pt-2">
                            <hr class="border-gray-200">
                        </li>
                        <li>
                            <a href="#" id="component-analyzer-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                                <span class="ml-6 font-semibold">Component 분석기</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" id="component-report-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                                <span class="ml-6 font-semibold">Component 보고서</span>
                            </a>
                        </li>

                        <!-- Separator -->
                        <li class="pt-2">
                            <hr class="border-gray-200">
                        </li>

                        <!-- CATS -->
                        <li class="pt-2">
                            <span class="ml-3 text-xs font-semibold text-gray-500 uppercase tracking-wider">CATS</span>
                        </li>
                        <li class="pt-2">
                            <hr class="border-gray-200">
                        </li>
                        <li>
                            <a href="#" id="cats-sampler-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                                <span class="ml-6 font-semibold">CATS SAMPLER</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" id="cats-sample-maker-tab" class="flex items-center p-3 text-gray-700 rounded-lg hover:bg-gray-100 group">
                                <span class="ml-6 font-semibold">CATS SAMPLE REPLACER</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main id="main-content" class="flex-1 p-8 overflow-y-auto bg-gray-100">
        <!-- Home Content -->
        <div id="home-content">
            <h2 class="text-3xl font-bold text-gray-800">Nexacro Utils에 오신 것을 환영합니다!</h2>
            <p class="mt-4 text-gray-600">
                <strong>Nexacro Utils</strong>는 넥사크로 애플리케이션 개발 및 분석을 위한 통합 유틸리티 웹입니다. 컴포넌트와 메타정보의 복잡한 구조를 시각화하고, 각종 데이터를 손쉽게 생성 및 수정할 수 있는 강력한 기능들을 제공합니다.
            </p>
            <div class="mt-8 space-y-6">
                <div>
                    <h3 class="text-2xl font-semibold text-gray-800 border-b pb-2">주요 기능</h3>
                </div>
                <div class="space-y-6">
                    <!-- Metainfo Section -->
                    <div class="p-6 border rounded-xl bg-white shadow-sm hover:shadow-md transition-shadow duration-300">
                        <h4 class="font-bold text-xl text-gray-800 mb-3">Metainfo</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li><strong>Metainfo 분석기:</strong> .info 파일의 내용을 분석하고, 이벤트, 메서드, 상태, 컨트롤 정보를 CSV 파일로 추출합니다.</li>
                            <li><strong>Metainfo Generator:</strong> 템플릿을 기반으로 새로운 .info 파일을 손쉽게 생성하고 관리합니다.</li>
                        </ul>
                    </div>
                    <!-- Component Section -->
                    <div class="p-6 border rounded-xl bg-white shadow-sm hover:shadow-md transition-shadow duration-300">
                        <h4 class="font-bold text-xl text-gray-800 mb-3">Component</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li><strong>Component 분석기:</strong> 컴포넌트의 상속 구조, 속성, 이벤트를 시각화하고 코드와 메타정보를 비교 분석합니다.</li>
                            <li><strong>Component 보고서:</strong> 모든 컴포넌트의 분석 결과를 종합하여 리포트를 생성합니다.</li>
                        </ul>
                    </div>
                    <!-- CATS Section -->
                    <div class="p-6 border rounded-xl bg-white shadow-sm hover:shadow-md transition-shadow duration-300">
                        <h4 class="font-bold text-xl text-gray-800 mb-3">CATS</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li><strong>CATS SAMPLER:</strong> CATS 테스트를 위한 샘플러 기능을 제공합니다. (준비중)</li>
                            <li><strong>CATS SAMPLE REPLACER:</strong> XFDL 파일에서 스크립트를 추출하고, CATS 테스트용으로 수정 및 생성합니다.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <p class="mt-10 text-center text-gray-500">
                좌측 사이드바에서 원하는 기능을 선택하여 지금 바로 시작해보세요.
            </p>
        </div>

            <!-- Metainfo Analyzer Content -->
            <div id="metainfo-analyzer-content" class="hidden">
                <h2 class="text-3xl font-bold text-gray-800">Metainfo 분석기</h2>
                <div id="xmlCsvTab" class="tab-content space-y-8 mt-8 bg-white">
                    <div class="p-6 border border-gray-200 rounded-lg space-y-6">
                        <h2 class="text-2xl font-bold text-gray-800">INFO 분석 및 CSV 생성</h2>
                        <div class="flex flex-col space-y-4">
                            <label for="xmlFileInput" class="text-lg font-semibold text-gray-700">INFO 파일 선택:</label>
                            <input type="file" id="xmlFileInput" accept=".info" class="w-full p-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/>
                            <p class="text-sm text-gray-500">분석할 INFO 메타 정보 파일을 선택하세요. (예: SpinField.info)</p>
                            <textarea id="xmlInput" class="hidden"></textarea>
                        </div>
                        <div class="flex justify-center flex-wrap gap-6">
                            <button id="generateCSVEvent" class="px-8 py-3 bg-green-600 text-white font-bold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-200">
                                이벤트 CSV 다운로드
                            </button>
                            <button id="generateCSVMethod" class="px-8 py-3 bg-purple-600 text-white font-bold rounded-lg shadow-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-200">
                                메서드 CSV 다운로드
                            </button>
                            <button id="generateCSVStatus" class="px-8 py-3 bg-yellow-500 text-white font-bold rounded-lg shadow-md hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-offset-2 transition duration-200">
                                상태 CSV 다운로드
                            </button>
                            <button id="generateCSVControl" class="px-8 py-3 bg-red-500 text-white font-bold rounded-lg shadow-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 transition duration-200">
                                컨트롤 CSV 다운로드
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Component Analyzer Content -->
            <div id="component-analyzer-content" class="hidden">
                <!-- Search Input Field -->
                <div class="mb-6">
                    <label for="search-input" class="block text-sm font-medium text-gray-600 mb-2">Search Component</label>
                    <input type="text" id="search-input" placeholder="e.g., Button"
                        class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm transition">
                </div>

                <!-- Pre-search Container -->
                <div id="pre-search-container" class="text-center text-gray-500 p-10 border-2 border-dashed border-gray-300 rounded-lg">
                    <!-- Annotation Bar Chart -->
                    <div id="annotation-chart-container" class="mb-8">
                        <div class="flex items-center justify-center mb-4">
                            <h3 class="text-2xl font-bold text-gray-800">파일 당 주석 수</h3>
                            <svg id="chart-tooltip-trigger" class="w-5 h-5 ml-2 text-gray-400 cursor-pointer" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm0-12a2 2 0 00-2 2h2a2 2 0 100-4H8a4 4 0 014 4v1a1 1 0 01-2 0v-1a2 2 0 00-2-2zm-1 6a1 1 0 100 2h2a1 1 0 100-2H9z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <svg id="annotation-bar-chart-svg" class="w-full"></svg>
                    </div>
                    <!-- Annotation Details -->
                    <div id="annotation-details-container" class="mt-4 text-left">
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">Annotation Details</h3>
                        <div id="annotation-cards-container" class="space-y-6">
                            <!-- Annotation cards will be populated by JavaScript -->
                        </div>
                    </div>
                    <div id="no-annotation-message" class="hidden">
                        <h3 class="text-xl font-semibold">Search for a Component</h3>
                        <p class="mt-2">분석할 컴포넌트를 검색하세요.</p>
                    </div>
                </div>

                <div id="button-container" class="hidden">
                    <!-- Buttons will be dynamically inserted here by JavaScript -->
                    <p id="loading-message" class="text-center text-gray-500 col-span-full text-lg">Loading data...</p>
                </div>

                <!-- Visualization Container -->
                <div id="visualization-container" class="hidden">
                    <div id="graph-header" class="flex justify-between items-center mb-6">
                        <h2 class="text-3xl font-bold text-gray-800">Component Analysis</h2>
                        <button id="download-xlsx-button"
                            class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out">
                            Download Analysis (XLSX)
                        </button>
                    </div>

                    <!-- Top section with Pie Charts and Tables -->
                    <div class="flex flex-wrap -mx-4 mb-8">
                        <!-- Left Column: Properties -->
                        <div class="w-full lg:w-1/2 px-4 mb-8 lg:mb-0">
                            <div class="bg-white rounded-lg shadow-lg p-4 h-full flex flex-col">
                                <div id="property-pie-chart-container" class="flex-grow flex flex-col" style="height: 400px;">
                                    <p id="pie-chart-component-name" class="text-xl font-bold text-gray-800 text-center pt-2"></p>
                                    <div class="flex-grow flex justify-center items-center">
                                        <svg id="property-pie-chart-svg" class="w-full h-full"></svg>
                                    </div>
                                    <div class="text-xs text-gray-600 text-left p-2">
                                        <ul>
                                            <li class="flex items-center mb-1"><span id="legend-common-prop" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Common:</b> In code & metainfo.</li>
                                            <li class="flex items-center mb-1"><span id="legend-missing-prop" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Missing:</b> In code, not metainfo.</li>
                                            <li class="flex items-center"><span id="legend-extra-prop" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Extra:</b> In metainfo, not code.</li>
                                        </ul>
                                    </div>
                                </div>
                                 <div id="property-table-container" class="relative mt-4 p-4 border-t border-gray-200 hidden" style="height: 300px; overflow-y: auto;">
                                    <h3 id="property-table-title" class="text-lg font-bold text-gray-800 mb-2">Properties</h3>
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <tbody id="property-table-body" class="bg-white divide-y divide-gray-200">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column: Events -->
                        <div class="w-full lg:w-1/2 px-4">
                             <div class="bg-white rounded-lg shadow-lg p-4 h-full flex flex-col">
                                <div id="event-pie-chart-container" class="flex-grow flex flex-col" style="height: 400px;">
                                    <p id="event-pie-chart-component-name" class="text-xl font-bold text-gray-800 text-center pt-2"></p>
                                    <div class="flex-grow flex justify-center items-center">
                                        <svg id="event-pie-chart-svg" class="w-full h-full"></svg>
                                    </div>
                                    <div class="text-xs text-gray-600 text-left p-2">
                                        <ul>
                                            <li class="flex items-center mb-1"><span id="legend-common-event" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Common:</b> In code & metainfo.</li>
                                            <li class="flex items-center mb-1"><span id="legend-missing-event" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Missing:</b> In code, not metainfo.</li>
                                            <li class="flex items-center"><span id="legend-extra-event" class="w-3 h-3 inline-block mr-2 rounded-sm"></span><b>Extra:</b> In metainfo, not code.</li>
                                        </ul>
                                    </div>
                                </div>
                                <div id="event-table-container" class="relative mt-4 p-4 border-t border-gray-200 hidden" style="height: 300px; overflow-y: auto;">
                                    <h3 id="event-table-title" class="text-lg font-bold text-gray-800 mb-2">Events</h3>
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <tbody id="event-table-body" class="bg-white divide-y divide-gray-200">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bottom section with Inheritance and Sub-elements Graphs -->
                    <div class="flex flex-wrap -mx-4 mb-8">
                        <!-- Left: Inheritance Graph -->
                        <div class="w-full lg:w-1/5 px-4 mb-8 lg:mb-0">
                            <div class="bg-white rounded-lg shadow-lg p-6 h-full">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Inheritance Graph</h3>
                                <div id="graph-container" class="relative bg-gray-50 rounded-lg w-full" style="height: 600px;">
                                    <svg id="inheritance-graph-svg" class="w-full h-full border border-gray-200 rounded-md"></svg>
                                </div>
                            </div>
                        </div>
                        <!-- Right: Sub-elements Graph -->
                        <div class="w-full lg:w-4/5 px-4">
                            <div class="bg-white rounded-lg shadow-lg p-6 h-full">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Sub-elements Graph</h3>
                                <div id="sub-elements-graph-container" class="relative bg-gray-50 rounded-lg w-full" style="height: 600px;">
                                    <svg id="sub-elements-graph-svg" class="w-full h-full border border-gray-200 rounded-md"></svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Impact Analysis Section -->
                    <div id="impact-analysis-container" class="bg-white rounded-lg shadow-lg p-6 hidden">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Impact Analysis</h3>
                        <div class="mb-4">
                            <input type="text" id="impact-analysis-search-input" placeholder="Search by function name..." class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div id="impact-analysis-content-container" class="space-y-6">
                            <!-- Direct Calls -->
                            <div id="direct-calls-container" class="bg-gray-50 p-4 rounded-lg hidden">
                                <h4 class="text-lg font-semibold text-gray-700 mb-2">Direct Function Calls: 선택된 컴포넌트의 함수가 다른 컴포넌트를 직접 호출하는 경우</h4>
                                <div id="direct-calls-content" class="overflow-y-auto" style="max-height: 300px;">
                                    <!-- Content will be populated by JavaScript -->
                                </div>
                            </div>
                            <!-- Implicit Inheritance -->
                            <div id="implicit-usage-container" class="bg-gray-50 p-4 rounded-lg hidden">
                                <h4 class="text-lg font-semibold text-gray-700 mb-2">Implicit Inheritance Usage: 자식 컴포넌트가 부모의 함수/속성을 재정의 없이 사용하는 경우</h4>
                                <div id="implicit-usage-content" class="overflow-y-auto" style="max-height: 300px;">
                                    <!-- Content will be populated by JavaScript -->
                                </div>
                            </div>
                            <!-- Explicit Inheritance -->
                            <div id="explicit-calls-container" class="bg-gray-50 p-4 rounded-lg hidden">
                                <h4 class="text-lg font-semibold text-gray-700 mb-2">Explicit Inheritance Calls: 자식 컴포넌트가 부모의 함수/속성을 명시적으로 호출하는 경우</h4>
                                <div id="explicit-calls-content" class="overflow-y-auto" style="max-height: 300px;">
                                    <!-- Content will be populated by JavaScript -->
                                </div>
                            </div>
                             <div id="no-impact-found-message" class="hidden text-center text-gray-500 py-4">
                                <p>No impacts found for this component.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Component Report Content -->
            <div id="component-report-content" class="hidden">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Component-wise Analysis Report</h2>
                <p class="text-gray-600 mb-8">A summary of property and event analysis for all components.</p>
                
                <!-- Legend for the charts -->
                <div class="flex justify-center space-x-6 mb-8 text-sm text-gray-700">
                    <div class="flex items-center"><span class="w-4 h-4 inline-block mr-2 rounded-sm" style="background-color: #4bc0c0;"></span>Common</div>
                    <div class="flex items-center"><span class="w-4 h-4 inline-block mr-2 rounded-sm" style="background-color: #ff6384;"></span>Missing in Metainfo</div>
                    <div class="flex items-center"><span class="w-4 h-4 inline-block mr-2 rounded-sm" style="background-color: #ffcd56;"></span>Extra in Metainfo</div>
                </div>

                <div id="report-charts-container" class="space-y-10">
                    <!-- Stacked bar charts will be dynamically inserted here -->
                </div>
            </div>

            <!-- CATS Sampler Content -->
            <div id="cats-sampler-content" class="hidden">
                <h2 class="text-3xl font-bold text-gray-800">CATS SAMPLER</h2>
                <p class="mt-4 text-gray-600">This is the boilerplate for the CATS Sampler content.</p>
            </div>

            <!-- CATS Sample Maker Content -->
            <div id="cats-sample-maker-content" class="hidden">
                <h2 class="text-3xl font-bold text-gray-800">CATS SAMPLE REPLACER</h2>
                        <div id="catsSamplingTab" class="tab-content space-y-8  mt-8 bg-white">
                            <div class="p-6 border border-gray-200 rounded-lg space-y-6">
                                <div class="flex justify-between items-center">
                                    <h2 class="text-2xl font-bold text-gray-800">CATS 샘플링 코드 생성</h2>
                                    <a href="./CATS_onBoarding.html" target="_blank" class="px-6 py-2 bg-sky-600 text-white font-bold rounded-lg shadow-md hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 transition duration-200 text-sm">
                                        CATS API 가이드
                                    </a>
                                </div>
                                <div class="flex flex-col space-y-4">
                                    <label for="xfdlFileInput" class="text-lg font-semibold text-gray-700">XFDL 파일 선택:</label>
                                    <input type="file" id="xfdlFileInput" accept=".xfdl" multiple class="w-full p-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/>
                                    <p class="text-sm text-gray-500">분석할 XFDL 파일을 선택하세요. (단일 또는 다중 선택 가능)</p>
                                </div>
                                <div id="singleFileAction" class="flex justify-center">
                                    <button id="extractScriptBtn" class="px-8 py-3 bg-teal-600 text-white font-bold rounded-lg shadow-md hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 transition duration-200">
                                        스크립트 추출
                                    </button>
                                </div>

                                <!-- 단일 파일 스크립트 수정 영역 -->
                                <div id="scriptOutput" class="mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200 space-y-6">
                                    <div>
                                        <h3 class="text-xl font-bold text-gray-800 mb-4">스크립트 수정 및 복사</h3>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                            <div>
                                                <label for="originalCompNameInput" class="block text-sm font-medium text-gray-700">Original Component Name</label>
                                                <input type="text" id="originalCompNameInput" class="mt-1 block w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md shadow-sm" readonly>
                                            </div>
                                            <div>
                                                <label for="newCompNameInput" class="block text-sm font-medium text-gray-700">New Component Name</label>
                                                <input type="text" id="newCompNameInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Enter new component name">
                                            </div>
                                            <div>
                                                <label for="authorNameInput" class="block text-sm font-medium text-gray-700">Author</label>
                                                <input type="text" id="authorNameInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Enter author's name">
                                            </div>
                                            <div>
                                                <label for="creationDateInput" class="block text-sm font-medium text-gray-700">Creation Date</label>
                                                <input type="text" id="creationDateInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="YYYY.MM.DD (Default: Today)">
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <label for="editableScript" class="block text-sm font-medium text-gray-700 mb-1">추출된 스크립트 (편집 가능)</label>
                                        <textarea id="editableScript" class="w-full p-4 rounded-md text-sm border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500" rows="15"></textarea>
                                    </div>
                                    <div class="flex gap-4 mt-4">
                                        <button id="copyScriptBtn" class="px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                            수정 및 복사
                                        </button>
                                        <button id="downloadXfdlBtn" class="px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
                                            XFDL 다운로드
                                        </button>
                                    </div>
                                </div>

                                <!-- 다중 파일 처리 영역 -->
                                <div id="batchScriptOutput" class="mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200 space-y-6">
                                    <h3 class="text-xl font-bold text-gray-800 mb-4">다중 CATS Script 작성</h3>
                                    <p id="batchFileCount" class="text-md text-gray-600"></p>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                        <div>
                                            <label for="batchAuthorNameInput" class="block text-sm font-medium text-gray-700">일괄 적용할 작성자명</label>
                                            <input type="text" id="batchAuthorNameInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="새 작성자명을 입력하세요">
                                        </div>
                                        <div>
                                            <label for="batchCreationDateInput" class="block text-sm font-medium text-gray-700">일괄 적용할 작성일</label>
                                            <input type="text" id="batchCreationDateInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="YYYY.MM.DD (기본값: 오늘)">
                                        </div>
                                        <div class="md:col-span-2">
                                            <label for="batchNewCompNameInput" class="block text-sm font-medium text-gray-700">일괄 적용할 새 컴포넌트명</label>
                                            <input type="text" id="batchNewCompNameInput" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="각 파일의 컴포넌트명을 이 이름으로 변경">
                                        </div>
                                    </div>
                                    <div class="flex justify-center">
                                        <button id="downloadAllXfdlBtn" class="px-8 py-3 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200">
                                            수정된 XFDL 전체 다운로드 (ZIP)
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
            </div>

                        <!-- CATS Sample Maker Content -->
            <div id="cats-sampler-content" class="hidden">
                <h2 class="text-3xl font-bold text-gray-800">CATS SAMPLER</h2>
            </div>

            <!-- MetaInfo Maker Content -->
            <div id="metainfo-maker-content" class="hidden">
                <h2 class="text-3xl font-bold text-gray-800">MetaInfo Generator</h2>
                
                <!-- Step 1: Template Creation -->
                <div id="metainfo-step-1" class="mt-8 bg-white p-6 border border-gray-200 rounded-lg space-y-6">
                    <h3 class="text-xl font-bold text-gray-800">Step 1: 템플릿 생성으로 시작하기</h3>
                    <p class="text-gray-600">
                        새로운 .info 파일을 만들거나, 기존 파일을 업로드하여 시작하세요.
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                        <!-- Option A: Create New -->
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-gray-700">새로운 info 파일 생성</label>
                            <button id="createNewInfoBtn" class="w-full px-6 py-2 bg-indigo-600 text-white font-bold rounded-lg shadow-md hover:bg-indigo-700">
                                Create New .info (Start with Blank Template)
                            </button>
                            <p class="text-sm text-gray-500 mt-1">빈 metainfo 템플릿으로 시작합니다.</p>
                        </div>
                        <!-- Option B: Upload Existing -->
                        <div class="space-y-2">
                            <label for="existingInfoFileInput" class="block text-sm font-medium text-gray-700">기존 metainfo 파일 업로드</label>
                            <input type="file" id="existingInfoFileInput" accept=".info" class="w-full p-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-yellow-50 file:text-yellow-700 hover:file:bg-yellow-100"/>
                            <p class="text-sm text-gray-500 mt-1">기존 .info 파일을 업로드하여 수정합니다.</p>
                        </div>
                    </div>
                     <div class="mt-4">
                        <label for="newComponentNameInput" class="block text-sm font-medium text-gray-700 mb-1">컴포넌트 이름 입력</label>
                        <input type="text" id="newComponentNameInput" placeholder="Enter new component name to replace" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 sm:border-indigo-500 sm:text-sm">
                        <p class="text-sm text-gray-500 mt-1">새 컴포넌트 이름을 입력하면 다운로드되는 파일의 컴포넌트 이름이 변경됩니다.</p>
                    </div>
                    <div class="mt-6 flex justify-end">
                        <button id="step1NextBtn" class="px-6 py-2 bg-green-600 text-white font-bold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 opacity-50 cursor-not-allowed" disabled>
                            Next Step
                        </button>
                    </div>
                </div>

                <!-- Step 2: Add Elements -->
                <div id="metainfo-step-2" class="mt-8 bg-white p-6 border border-gray-200 rounded-lg space-y-8 hidden">
                    <h3 class="text-xl font-bold text-gray-800">Step 2: Add or Review Elements</h3>
                    <p class="text-gray-600">
                        필요한 항목을 추가하거나 기존 항목을 검토/제거하세요.
                    </p>
                    
                    <!-- ObjectInfo Section -->
                    <div class="pt-4 border-t border-gray-200">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="text-xl font-semibold text-gray-800">ObjectInfo</h4>
                            <div>
                                <button id="edit-objectinfo-btn" class="px-4 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-sm">Edit</button>
                                <button id="save-objectinfo-btn" class="px-4 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 text-sm hidden">Save</button>
                            </div>
                        </div>
                        <div id="objectinfo-view-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-2 bg-gray-50 p-4 rounded-lg">
                            <!-- Read-only view for ObjectInfo will be dynamically inserted here -->
                        </div>
                        <div id="objectinfo-form-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 bg-gray-50 p-4 rounded-lg hidden">
                            <!-- Input fields for ObjectInfo will be dynamically inserted here -->
                        </div>
                    </div>

                    <!-- Row 1: Properties -->
                    <div class="pt-4 border-t border-gray-200">
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">Properties</h4>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <h5 class="font-medium text-gray-600">Add New Properties</h5>
                                    <button data-type="PropertyInfo" class="custom-add-btn px-3 py-1 text-sm bg-blue-500 text-white rounded-md hover:bg-blue-600">Add Custom</button>
                                </div>
                                <input type="text" id="property-search" placeholder="Search properties..." class="w-full p-2 border border-gray-300 rounded-lg mb-2">
                                <div id="properties-container" class="h-64 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Current Properties (from file)</h5>
                                <div id="selected-properties-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                                <h5 class="font-medium text-gray-600 mb-2 mt-4">Added Properties (by user)</h5>
                                <div id="added-properties-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 1.5: CSSInfo -->
                    <div class="pt-4 border-t border-gray-200">
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">CSSInfo</h4>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <h5 class="font-medium text-gray-600">Add New CSS Properties</h5>
                                    <button data-type="CSSInfo" class="custom-add-btn px-3 py-1 text-sm bg-blue-500 text-white rounded-md hover:bg-blue-600">Add Custom</button>
                                </div>
                                <input type="text" id="cssinfo-search" placeholder="Search CSS properties..." class="w-full p-2 border border-gray-300 rounded-lg mb-2">
                                <div id="cssinfo-container" class="h-64 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Current CSS Properties (from file)</h5>
                                <div id="selected-cssinfo-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                                <h5 class="font-medium text-gray-600 mb-2 mt-4">Added CSS Properties (by user)</h5>
                                <div id="added-cssinfo-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 2: Controls -->
                    <div class="pt-8 border-t border-gray-200">
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">Controls</h4>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <h5 class="font-medium text-gray-600">Add New Controls</h5>
                                    <button data-type="ControlInfo" class="custom-add-btn px-3 py-1 text-sm bg-blue-500 text-white rounded-md hover:bg-blue-600">Add Custom</button>
                                </div>
                                <input type="text" id="control-search" placeholder="Search controls..." class="w-full p-2 border border-gray-300 rounded-lg mb-2">
                                <div id="controls-container" class="h-64 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Current Controls (from file)</h5>
                                <div id="selected-controls-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                                <h5 class="font-medium text-gray-600 mb-2 mt-4">Added Controls (by user)</h5>
                                <div id="added-controls-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 3: Statuses -->
                    <div class="pt-8 border-t border-gray-200">
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">Statuses</h4>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <h5 class="font-medium text-gray-600">Add New Statuses</h5>
                                    <button data-type="StatusInfo" class="custom-add-btn px-3 py-1 text-sm bg-blue-500 text-white rounded-md hover:bg-blue-600">Add Custom</button>
                                </div>
                                <input type="text" id="status-search" placeholder="Search statuses..." class="w-full p-2 border border-gray-300 rounded-lg mb-2">
                                <div id="statuses-container" class="h-64 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Current Statuses (from file)</h5>
                                <div id="selected-statuses-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                                <h5 class="font-medium text-gray-600 mb-2 mt-4">Added Statuses (by user)</h5>
                                <div id="added-statuses-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 4: Methods -->
                    <div class="pt-8 border-t border-gray-200">
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">Methods</h4>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <h5 class="font-medium text-gray-600">Add New Methods</h5>
                                    <button data-type="MethodInfo" class="custom-add-btn px-3 py-1 text-sm bg-blue-500 text-white rounded-md hover:bg-blue-600">Add Custom</button>
                                </div>
                                <input type="text" id="method-search" placeholder="Search methods..." class="w-full p-2 border border-gray-300 rounded-lg mb-2">
                                <div id="methods-container" class="h-64 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Current Methods (from file)</h5>
                                <div id="selected-methods-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                                <h5 class="font-medium text-gray-600 mb-2 mt-4">Added Methods (by user)</h5>
                                <div id="added-methods-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 5: Events -->
                    <div class="pt-8 border-t border-gray-200">
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">Events</h4>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <h5 class="font-medium text-gray-600">Add New Events</h5>
                                    <button data-type="EventHandlerInfo" class="custom-add-btn px-3 py-1 text-sm bg-blue-500 text-white rounded-md hover:bg-blue-600">Add Custom</button>
                                </div>
                                <input type="text" id="event-search" placeholder="Search events..." class="w-full p-2 border border-gray-300 rounded-lg mb-2">
                                <div id="events-container" class="h-64 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-600 mb-2">Current Events (from file)</h5>
                                <div id="selected-events-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                                <h5 class="font-medium text-gray-600 mb-2 mt-4">Added Events (by user)</h5>
                                <div id="added-events-container" class="h-40 overflow-y-auto border rounded-lg p-2 bg-gray-50 space-y-1"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation to Step 3 -->
                    <div class="mt-8 flex justify-end">
                        <button id="step2NextBtn" class="px-6 py-2 bg-green-600 text-white font-bold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
                            Next Step
                        </button>
                    </div>
                </div>

                <!-- Step 3: Download Template -->
                <div id="metainfo-step-3" class="mt-8 bg-white p-6 border border-gray-200 rounded-lg space-y-4 hidden">
                    <h3 class="text-xl font-bold text-gray-800">Step 3: Download Template</h3>
                    <p class="text-gray-600 mb-4">
                        검토가 완료되면 아래 버튼을 클릭하여 최종 XLSX 템플릿을 다운로드하세요.
                    <button id="downloadTemplateBtn" class="w-full px-6 py-3 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        Generate and Download XLSX
                    </button>
                </div>

                <!-- Step 4: Upload and Generate -->
                <div id="metainfo-step-4" class="mt-8 bg-white p-6 border border-gray-200 rounded-lg space-y-4 hidden">
                    <h3 class="text-xl font-bold text-gray-800">Step 4: Generate .info File</h3>
                    <p class="text-gray-600 mb-4">작성한 XLSX 파일을 업로드하여 .info 파일을 생성하세요.</p>
                    <div class="flex flex-col space-y-4">
                        <input type="file" id="infoFileInput" accept=".xlsx" class="w-full p-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"/>
                        <button id="generateInfoBtn" class="px-6 py-2 bg-green-600 text-white font-bold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 opacity-50 cursor-not-allowed" disabled>
                            Generate .info File
                        </button>
                    </div>
                </div>

                <!-- Custom Item Modal -->
                <div id="custom-item-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
                    <div class="relative top-10 mx-auto p-5 border w-full max-w-lg shadow-lg rounded-md bg-white">
                        <div class="mt-3">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 text-center" id="custom-item-modal-title">Add Custom Item</h3>
                            <div id="custom-item-modal-form-container" class="mt-4 space-y-3 max-h-[60vh] overflow-y-auto p-2">
                                <!-- Form fields will be dynamically inserted here -->
                            </div>
                            <div class="items-center px-4 py-3 mt-4 flex justify-end space-x-4">
                                <button id="cancel-custom-item-btn" class="px-4 py-2 bg-gray-300 text-gray-800 text-base font-medium rounded-md shadow-sm hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-200">
                                    Cancel
                                </button>
                                <button id="save-custom-item-btn" class="px-4 py-2 bg-green-500 text-white text-base font-medium rounded-md shadow-sm hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-300">
                                    Save
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script type="module" src="main.js"></script>
    <script type="module" src="./js/features/cats-sample-replacer/index.js"></script>
    <script type="module" src="./js/features/csv-generator/index.js"></script>
    <script type="module" src="./js/features/metainfo-maker/index.js"></script>
    <script type="module" src="./js/features/test-generator/index.js"></script>
    <script type="module" src="animations.js"></script>
</body>
</html>
